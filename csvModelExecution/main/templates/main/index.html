<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CSVModelExecution</title>

    {% load static %}
    {% block extrahead %}
    <link href="{% static 'main.css' %}" rel="stylesheet">
    {% endblock %}

</head>
<body>
<header>
    <h1>CSVによるモデル実行システム</h1>
</header>

<div class="wrapper">
    <h3>ファイルのアップロード</h3>
    <form action="" method="post" enctype="multipart/form-data">
        {% csrf_token %}
        <div id="drop-zone" style="border: 1px solid; padding: 30px; width: 35%;">
            <p>ファイルをドラッグ＆ドロップもしくは</p>
            <input type="file" multiple="multiple" name="file" id="file-input">
            <input type="submit" style="margin-top: 50px" value="UPLOAD">
        </div>
    </form>

    <div style='margin-top: 50px'>
        <h3>アップロード済みファイル</h3>
        {% for file in file_list %}
        <p>{{file}}</p>
        {% endfor %}

        <form method="post" action="insert" id="insert">
            {% csrf_token %}
            <p><input type="submit" value="DB登録"></p>
        </form>

        <form method="post" action="delete" id="delete">
            {% csrf_token %}
            <p><input type="submit" value="DBデータ削除"></p>
        </form>
    </div>

    <h3 style='margin-top: 50px'>結合データファイルの作成</h3>
    <p>結合形式：<select name="join" form="join">
        <option value="inner-join">INNER JOIN</option>
        <option value="left-right-outer-join">LEFT/RIGHT OUTER JOIN</option>
    </select></p>

    <form method="post" action="join" id="join">
        {% csrf_token %}
        <p><input type="submit" value="作成する"></p>
    </form>

    <div style='margin-top: 50px'>
        <h3>モデルの構築</h3>
        <form method="post" action="model-create" id="model-create">
            {% csrf_token %}
            <p>予測対象：「paid_flg」</p>
            <p><input type="submit" value="構築する"></p>
        </form>
    </div>

    <div style='margin-top: 50px'>
        <h3>モデル適用結果</h3>
        <form method="post" action="download" id="download">
            {% csrf_token %}
            <p><input type="submit" class="download-btn" value="ダウンロード"></p>
        </form>
        <div class="preview">
            <table class="table" border=1>
                <caption>プレビュー</caption>
                <tr><th>id</th><th>スコア</th></tr>
                <tr><td>0</td><td>0.0..</td></tr>
                <tr><td>1</td><td>0.0..</td></tr>
                <tr><td>2</td><td>0.0..</td></tr>
            </table>
        </div>

    </div>
</div>

<footer>
    <p>(c)copy right</p>
</footer>
</body>
</html>

<script type="text/javascript">

    var dropZone = document.getElementById('drop-zone');
    var fileInput = document.getElementById('file-input');

    dropZone.addEventListener('dragover', function(e) {
        e.stopPropagation();
        e.preventDefault();
        this.style.background = '#e1e7f0';
    }, false);

    dropZone.addEventListener('dragleave', function(e) {
        e.stopPropagation();
        e.preventDefault();
        this.style.background = '#ffffff';
    }, false);

    fileInput.addEventListener('change', function () {
        previewFile(this.files[0]);
    });

    dropZone.addEventListener('drop', function(e) {
        e.stopPropagation();
        e.preventDefault();
        this.style.background = '#ffffff'; //背景色を白に戻す
        var files = e.dataTransfer.files; //ドロップしたファイルを取得
        fileInput.files = files; //inputのvalueをドラッグしたファイルに置き換える。
        previewFile(files[0]);
    }, false);



</script>